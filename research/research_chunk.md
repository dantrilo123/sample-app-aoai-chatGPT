# チャンキングの影響の実験

## インデックスのサイズへの影響
ベクトル化を行った際のインデックスのサイズは以下の通り。
| チャンク長-オーバーラップ長 | チャンク数 | ベクターインデックスサイズ  | 合計ストレージサイズ |
|:-----------------------------:|:----:|:-----------:|:-----------:|
| 512-0               | 177  | 2.09 MB     |  7.49 MB    |
| 512-128             | 227  | 2.68 MB     |  9.57 MB    |
| 1024-0              |  96  | 1.13 MB     |  4.27 MB    |
| 1024-256            | 113  | 1.33 MB     |  5.03 MB    |
| 2000-0              |  52  | 628.94 KB   |  2.55 MB    |
| 2000-500            |  54  | 653.19 KB   |  2.71 MB    |

参考　blobストレージに保存されているドキュメントのファイル容量は27.81 MB 

### インデックスサイズに対する考察
- チャンク長を小さくするとチャンク数、インデックスサイズ、合計ストレージサイズは大きくなる。
- インデックスサイズとチャンク数はチャンク長におおよそ反比例して増加するが、合計ストレージサイズはその限りではない。
- オーバーラップ長を設定するとチャンク数が増加するが、チャンク長：オーバーラップ長＝N:Mの時おおよそ(N＋M)/(N)倍になる。
- 最も合計ストレージサイズが大きい512-128の設定の場合、元ドキュメントの1/3程度のストレージサイズになっている。

## 検索への影響

### 検索速度への影響
チャンク長やオーバーラップ長毎のAPIの実行速度は以下の通りです。

| チャンク長 - オーバーラップ長 | API実行速度 |
|:-----------------------------:|:------------:|
|           512 - 0            |   666.6 ms   |
|         512 - 128            |   647.2 ms   |
|          1024 - 0            |   665.8 ms   |
|        1024 - 256            |   666.4 ms   |
|          2000 - 0            |   788.1 ms   |
|        2000 - 500            |   721.3 ms   |

（補足）「Neuronの導入事例について教えて」というクエリに対する検索APIの実行速度を10回実行の平均値で算出しています。


## 回答への影響





  



